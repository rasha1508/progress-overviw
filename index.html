<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Progress Overview</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600&family=Inter:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        background: trasnparent; /* Cream/Ivory background */
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 20px;
        font-family: "Inter", sans-serif;
        color: #4a4a4a; /* Slate Gray for text */
      }
      .widget-container {
        width: 100%;
        max-width: 500px; /* Increased width */
        background: #fdf6f0; /* Cream/Ivory main background */
        border-radius: 16px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.06);
        overflow: hidden;
        border: 1px solid rgba(74, 74, 74, 0.1);
        position: relative;
      }
      .widget-content {
        padding: 25px 20px; /* Increased top padding */
      }
      .progress-section {
        margin-bottom: 20px;
      }
      .progress-row {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-bottom: 20px;
        position: relative;
      }
      .progress-percentage {
        text-align: center;
        font-size: 2rem;
        font-weight: 700;
        color: #4a4a4a;
        margin-bottom: 5px;
        font-family: "Playfair Display", serif;
        letter-spacing: -0.5px;
      }
      .progress-bar-container {
        width: 100%;
        height: 12px;
        background: #f0e6d2;
        border-radius: 6px;
        overflow: hidden;
        position: relative;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
      }
      .progress-bar-container:hover {
        box-shadow: 0 4px 12px rgba(163, 177, 138, 0.25), inset 0 2px 4px rgba(0, 0, 0, 0.05);
        transform: translateY(-2px);
      }
      .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #a3b18a, #8da070);
        border-radius: 6px;
        transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        width: 0%; /* Start from 0% */
        box-shadow: 0 0 10px rgba(163, 177, 138, 0.5);
      }
      .progress-bar::after {
        content: '';
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        width: 20px;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3));
        border-radius: 0 6px 6px 0;
      }
      .stats-row {
        display: flex;
        gap: 12px;
        margin-top: 25px; /* Added space between progress details and stats */
      }
      .stat-item {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        background: white;
        padding: 15px 10px; /* Increased padding */
        border-radius: 12px;
        border: 1px solid rgba(74, 74, 74, 0.1);
        transition: all 0.3s ease;
        cursor: pointer;
        position: relative;
        overflow: hidden;
      }
      .stat-item::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: #a3b18a;
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }
      .stat-item:hover::before {
        transform: translateX(0);
      }
      .stat-item:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 16px rgba(163, 177, 138, 0.2);
        border-color: #a3b18a;
      }
      .stat-number {
        font-size: 1.5rem; /* Increased font size */
        font-weight: 600;
        color: #4a4a4a;
        line-height: 1;
        margin-bottom: 5px;
      }
      .stat-label {
        font-size: 0.7rem; /* Slightly increased */
        color: #4a4a4a;
        opacity: 0.8;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      .stat-icon {
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 0.8rem;
        color: #a3b18a;
        opacity: 0;
        transition: opacity 0.3s ease;
      }
      .stat-item:hover .stat-icon {
        opacity: 1;
      }
      .progress-tooltip {
        position: absolute;
        top: -40px;
        background: #4a4a4a;
        color: white;
        padding: 6px 12px;
        border-radius: 6px;
        font-size: 0.8rem;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        white-space: nowrap;
        z-index: 10;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      .progress-tooltip::after {
        content: '';
        position: absolute;
        top: 100%;
        left: 50%;
        margin-left: -5px;
        border-width: 5px;
        border-style: solid;
        border-color: #4a4a4a transparent transparent transparent;
      }
      .progress-bar-container:hover .progress-tooltip {
        opacity: 1;
      }
      .progress-details {
        display: flex;
        justify-content: space-between;
        margin-top: 10px;
        font-size: 0.8rem;
        color: #4a4a4a;
        opacity: 0.7;
      }
      .progress-detail-item {
        display: flex;
        align-items: center;
        gap: 5px;
      }
      .progress-detail-item i {
        color: #a3b18a;
      }
      .progress-pulse {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(163, 177, 138, 0.3);
        border-radius: 6px;
        opacity: 0;
        transform: scale(0.95);
        transition: all 0.3s ease;
        pointer-events: none;
      }
      .progress-bar-container:active .progress-pulse {
        opacity: 1;
        transform: scale(1);
      }
      .progress-glow {
        position: absolute;
        top: -5px;
        left: -5px;
        right: -5px;
        bottom: -5px;
        background: radial-gradient(circle, rgba(163, 177, 138, 0.3) 0%, transparent 70%);
        border-radius: 11px;
        opacity: 0;
        transition: opacity 0.3s ease;
        pointer-events: none;
      }
      .progress-bar-container:hover .progress-glow {
        opacity: 1;
      }
    </style>
  </head>
  <body>
    <div class="widget-container">
      <div class="widget-content">
        <div class="progress-section">
          <div class="progress-row">
            <div class="progress-percentage" id="progressPercentage">0%</div>
            <div class="progress-bar-container" id="progressBarContainer">
              <div class="progress-glow"></div>
              <div class="progress-bar" id="progressBar"></div>
              <div class="progress-pulse"></div>
              <div class="progress-tooltip" id="progressTooltip">Click to adjust progress</div>
            </div>
          </div>
          <div class="progress-details">
            <div class="progress-detail-item">
              <i class="fas fa-chart-line"></i>
              <span id="progressStatus">Getting started</span>
            </div>
            <div class="progress-detail-item">
              <i class="fas fa-calendar-check"></i>
              <span id="lastUpdated">Just now</span>
            </div>
          </div>
          <div class="stats-row">
            <div class="stat-item" id="totalTasksStat" title="View all tasks">
              <div class="stat-number" id="totalTasks">0</div>
              <div class="stat-label">Total Tasks</div>
              <i class="fas fa-tasks stat-icon"></i>
            </div>
            <div class="stat-item" id="completedTasksStat" title="View completed tasks">
              <div class="stat-number" id="completedTasks">0</div>
              <div class="stat-label">Completed</div>
              <i class="fas fa-check-circle stat-icon"></i>
            </div>
            <div class="stat-item" id="inProgressTasksStat" title="View in-progress tasks">
              <div class="stat-number" id="inProgressTasks">0</div>
              <div class="stat-label">In Progress</div>
              <i class="fas fa-spinner stat-icon"></i>
            </div>
            <div class="stat-item" id="upcomingTasksStat" title="View upcoming tasks">
              <div class="stat-number" id="upcomingTasks">0</div>
              <div class="stat-label">Upcoming</div>
              <i class="fas fa-clock stat-icon"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Function to load assignments from localStorage
        function loadAssignments() {
          return JSON.parse(localStorage.getItem("assignments")) || [];
        }
        
        // Function to update the progress widget
        function updateProgressWidget() {
          const assignments = loadAssignments();
          
          // Calculate statistics
          const totalTasks = assignments.length;
          const completedTasks = assignments.filter(
            (a) => a.progress === 100
          ).length;
          const inProgressTasks = assignments.filter(
            (a) => a.progress > 0 && a.progress < 100
          ).length;
          const upcomingTasks = assignments.filter(
            (a) => a.progress < 100
          ).length;
          
          // Calculate overall progress percentage
          let totalProgress = 0;
          assignments.forEach((assignment) => {
            totalProgress += assignment.progress;
          });
          const overallProgress =
            totalTasks > 0 ? Math.round(totalProgress / totalTasks) : 0;
          
          // Update stats
          document.getElementById("totalTasks").textContent = totalTasks;
          document.getElementById("completedTasks").textContent =
            completedTasks;
          document.getElementById("inProgressTasks").textContent =
            inProgressTasks;
          document.getElementById("upcomingTasks").textContent = upcomingTasks;
          
          // Update progress status text
          const progressStatus = document.getElementById("progressStatus");
          if (overallProgress === 0) {
            progressStatus.textContent = "Getting started";
          } else if (overallProgress < 25) {
            progressStatus.textContent = "Just beginning";
          } else if (overallProgress < 50) {
            progressStatus.textContent = "Making progress";
          } else if (overallProgress < 75) {
            progressStatus.textContent = "Halfway there";
          } else if (overallProgress < 100) {
            progressStatus.textContent = "Almost done";
          } else {
            progressStatus.textContent = "All completed!";
          }
          
          // Update last updated time
          const now = new Date();
          document.getElementById("lastUpdated").textContent = 
            now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
          
          // Update progress bar with animation
          const progressBar = document.getElementById("progressBar");
          const progressPercentage = document.getElementById("progressPercentage");
          
          // Animate from current width to new width
          const currentWidth = parseInt(progressBar.style.width) || 0;
          const targetWidth = overallProgress;
          
          // Use a simple animation loop
          const duration = 1500; // 1.5 seconds
          const startTime = Date.now();
          
          function animateProgress() {
            const elapsed = Date.now() - startTime;
            const progress = Math.min(elapsed / duration, 1);
            const width = currentWidth + (targetWidth - currentWidth) * progress;
            
            progressBar.style.width = width + '%';
            progressPercentage.textContent = Math.round(width) + '%';
            
            if (progress < 1) {
              requestAnimationFrame(animateProgress);
            }
          }
          
          animateProgress();
        }
        
        // Progress bar interaction
        const progressBarContainer = document.getElementById("progressBarContainer");
        const progressTooltip = document.getElementById("progressTooltip");
        const progressPercentage = document.getElementById("progressPercentage");
        
        progressBarContainer.addEventListener("click", function(e) {
          const rect = progressBarContainer.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const width = rect.width;
          const percentage = Math.round((x / width) * 100);
          
          // Update tooltip position
          progressTooltip.style.left = x + "px";
          progressTooltip.textContent = `Set to ${percentage}%`;
          
          // Show tooltip temporarily
          progressTooltip.style.opacity = "1";
          setTimeout(() => {
            progressTooltip.style.opacity = "0";
          }, 1500);
          
          // Update progress bar and percentage
          const progressBar = document.getElementById("progressBar");
          progressBar.style.width = percentage + '%';
          progressPercentage.textContent = percentage + '%';
          
          // Here you could add functionality to actually update the progress
          // For now, we'll just show the tooltip
        });
        
        // Update tooltip position on hover
        progressBarContainer.addEventListener("mousemove", function(e) {
          const rect = progressBarContainer.getBoundingClientRect();
          const x = e.clientX - rect.left;
          
          // Update tooltip position
          progressTooltip.style.left = x + "px";
          
          // Calculate percentage at mouse position
          const percentage = Math.round((x / rect.width) * 100);
          progressTooltip.textContent = `${percentage}%`;
        });
        
        progressBarContainer.addEventListener("mouseleave", function() {
          progressTooltip.style.opacity = "0";
        });
        
        // Stat item click interactions
        document.getElementById("totalTasksStat").addEventListener("click", function() {
          showNotification("Showing all tasks");
          this.style.transform = "scale(0.95)";
          setTimeout(() => {
            this.style.transform = "";
          }, 200);
        });
        
        document.getElementById("completedTasksStat").addEventListener("click", function() {
          showNotification("Showing completed tasks");
          this.style.transform = "scale(0.95)";
          setTimeout(() => {
            this.style.transform = "";
          }, 200);
        });
        
        document.getElementById("inProgressTasksStat").addEventListener("click", function() {
          showNotification("Showing in-progress tasks");
          this.style.transform = "scale(0.95)";
          setTimeout(() => {
            this.style.transform = "";
          }, 200);
        });
        
        document.getElementById("upcomingTasksStat").addEventListener("click", function() {
          showNotification("Showing upcoming tasks");
          this.style.transform = "scale(0.95)";
          setTimeout(() => {
            this.style.transform = "";
          }, 200);
        });
        
        // Function to show notification
        function showNotification(message) {
          // Create notification element if it doesn't exist
          let notification = document.getElementById("notification");
          if (!notification) {
            notification = document.createElement("div");
            notification.id = "notification";
            notification.style.position = "fixed";
            notification.style.top = "20px";
            notification.style.right = "20px";
            notification.style.background = "#a3b18a";
            notification.style.color = "white";
            notification.style.padding = "14px 18px";
            notification.style.borderRadius = "8px";
            notification.style.boxShadow = "0 4px 12px rgba(0, 0, 0, 0.1)";
            notification.style.zIndex = "1000";
            notification.style.fontSize = "0.9rem";
            notification.style.opacity = "0";
            notification.style.transform = "translateY(-20px)";
            notification.style.transition = "all 0.3s ease";
            document.body.appendChild(notification);
          }
          
          notification.textContent = message;
          notification.style.opacity = "1";
          notification.style.transform = "translateY(0)";
          
          setTimeout(() => {
            notification.style.opacity = "0";
            notification.style.transform = "translateY(-20px)";
          }, 2000);
        }
        
        // Listen for storage changes to update the widget
        window.addEventListener("storage", function (e) {
          if (e.key === "assignments") {
            updateProgressWidget();
          }
        });
        
        // Initial update with delay to ensure smooth animation
        setTimeout(() => {
          updateProgressWidget();
        }, 300);
      });
    </script>
  </body>
</html>
